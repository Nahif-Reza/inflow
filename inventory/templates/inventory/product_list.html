{% extends 'base.html' %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-gray-900 to-gray-800 py-12 px-6 text-white">
  <div class="max-w-7xl mx-auto">

      <!-- Summary Statistics -->
  <div class="flex justify-between mb-8 text-gray-300">
    <div>Total Products: <span class="font-semibold text-white">{{ total_products }}</span></div>
    <div>Total Categories: <span class="font-semibold text-white">{{ total_categories }}</span></div>
    <div>Total Stock Value: <span class="font-semibold text-white">৳{{ total_stock_value|floatformat:2 }}</span></div>
    <div>Low Stock Items: <span class="font-semibold text-red-500">{{ low_stock_count }}</span></div>
  </div>

    <!-- Header + Action Bar -->
    <div class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4">
      <form method="GET" class="flex w-full md:w-auto">
        <input
          type="text"
          name="q"
          placeholder="Search by name or ID"
          value="{{ request.GET.q }}"
          class="bg-gray-800 border border-gray-600 rounded-l-lg px-4 py-2 w-full focus:outline-none focus:ring-2 focus:ring-indigo-500 text-white"
        />
        <button type="submit" class="bg-indigo-600 text-white px-4 py-2 rounded-r-lg hover:bg-indigo-700">
          Search
        </button>
      </form>

      <div class="flex space-x-4">
        <a href="{% url 'add_product' %}" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">
          Add Product
        </a>
        <a href="{% url 'add_category' %}" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
          Add Category
        </a>

        <a href="{% url 'view_categories' %}" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
          View Category
        </a>

      </div>
    </div>

    <!-- Product Table -->
    <div class="bg-gray-900 rounded-xl shadow-md overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-700">
        <thead class="bg-gray-800 text-gray-400">
          <tr>
            <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">SKU</th>
            <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Name</th>
            <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Cost</th>
            <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Price</th>
            <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Category</th>
            <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Stock</th>
            <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Actions</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-800">
          {% for product in products %}
          <tr class="hover:bg-gray-800 transition">
            <td class="px-6 py-4 text-sm font-mono">{{ product.sku }}</td>
            <td class="px-6 py-4 text-sm">{{ product.name }}</td>
            <td class="px-6 py-4 text-sm">৳{{ product.cost_price }}</td>
            <td class="px-6 py-4 text-sm">৳{{ product.sell_price }}</td>
            <td class="px-6 py-4 text-sm">{{ product.category }}</td>
            <td class="px-6 py-4 text-sm">
              {% if product.stock_quantity < 5 %}
                <span class="text-red-400 font-semibold">{{ product.stock_quantity }}</span>
              {% else %}
                {{ product.stock_quantity }}
              {% endif %}
            </td>
            <td class="px-6 py-4 text-sm space-x-2 whitespace-nowrap">
              <a href="{% url 'edit_product' product.id %}" class="text-indigo-400 hover:underline">Edit</a>
              <a href="{% url 'delete_product' product.id %}" class="text-red-400 hover:underline"
                 onclick="return confirm('Are you sure you want to delete this product?');">Delete</a>
              {% if product.stock_quantity < 5 %}
              <a href="{% url 'restock_product' product.id %}" class="text-green-400 hover:underline">Restock</a>
              {% endif %}
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="7" class="text-center py-6 text-gray-400">No products found.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

  </div>

</div>
{% endblock %}
